{"version":3,"file":"index.js","sources":["../src/components/Photo.styled.tsx","../src/components/Photo.tsx","../src/datastores/unsplash.ts","../src/components/UnsplashAssetSource.styled.tsx","../src/components/UnsplashAssetSource.tsx","../src/components/Icon.tsx","../src/index.ts"],"sourcesContent":["import { Card, Theme } from '@sanity/ui'\nimport styled from 'styled-components'\n\ntype SanityTheme = Theme['sanity']\n\ninterface Style {\n  studioTheme: SanityTheme\n}\n\nexport const Root = styled.div`\n  overflow: hidden;\n  background-origin: content-box;\n  background-repeat: no-repeat;\n  background-clip: border-box;\n  background-size: cover;\n  position: relative;\n  outline: none !important;\n  border: ${({ studioTheme }: Style) => `1px solid ${studioTheme.color.card.enabled.border}`};\n  box-sizing: content-box;\n  user-drag: none;\n\n  &:hover {\n    opacity: 0.85;\n  }\n\n  &:focus,\n  &:active {\n    border: 1px solid var(--input-border-color-focus);\n    box-shadow: inset 0 0 0 3px var(--input-border-color-focus);\n  }\n`\n\nexport const CreditLineLink = styled.a`\n  text-decoration: none;\n  cursor: pointer;\n`\n\nexport const CreditLine = styled(Card)`\n  ${({ theme }) => `\n     --creditline-fg: ${theme.sanity.color.card.enabled.fg};\n     --creditline-bg: ${theme.sanity.color.card.enabled.bg};\n   `};\n  user-drag: none;\n  position: absolute;\n  background-color: var(--creditline-bg);\n  bottom: 0;\n\n  [data-ui='Text'] {\n    color: var(--creditline-fg);\n  }\n`\n","import { Text, useTheme } from '@sanity/ui'\nimport React, { useCallback, useEffect, useRef } from 'react'\nimport { UnsplashPhoto } from '../types'\nimport { CreditLine, CreditLineLink, Root } from './Photo.styled'\n\ntype Props = {\n  data: UnsplashPhoto\n  width: number\n  height: number\n  onClick: (photo: UnsplashPhoto) => void\n  onKeyDown: (event: any) => void\n  active: boolean\n  onFocus: (photo: UnsplashPhoto) => void\n}\n\nconst UTM_SOURCE = 'sanity-plugin-asset-source-unsplash'\n\nexport default function Photo(props: Props) {\n  const { onClick, data, onKeyDown, onFocus, active, width, height } = props\n  const rootElm = useRef<HTMLDivElement>(null)\n  const prevActive = useRef<boolean>(false)\n\n  const handleClick = useCallback(() => {\n    onClick(data)\n  }, [onClick, data])\n\n  const handleCreditLineClicked = useCallback(\n    (event: any) => {\n      event.stopPropagation()\n      const url = `${data.links.html}?utm_source=${encodeURIComponent(\n        UTM_SOURCE\n      )}&utm_medium=referral`\n      window.open(url, data.id, 'noreferrer,noopener')\n    },\n    [data]\n  )\n\n  const handleKeyDown = useCallback(\n    (event: any) => {\n      onKeyDown(event)\n      if (event.keyCode === 13) {\n        onClick(data)\n      }\n    },\n    [onKeyDown, data, onClick]\n  )\n\n  const handleMouseDown = useCallback(() => {\n    onFocus(data)\n  }, [onFocus, data])\n\n  useEffect(() => {\n    if (!prevActive.current && active && rootElm.current) {\n      rootElm.current.focus()\n      onFocus(data)\n    }\n    prevActive.current = active\n    // data changing alone should not re-trigger effect\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [active])\n\n  const src = data.urls.small\n  const userName = data.user.name\n\n  const theme = useTheme().sanity\n  return (\n    <Root\n      ref={rootElm}\n      studioTheme={theme}\n      title={`Select image by ${userName} from Unsplash`}\n      tabIndex={0}\n      onKeyDown={handleKeyDown}\n      onMouseDown={handleMouseDown}\n      style={{\n        width: `${width}px`,\n        height: `${height}px`,\n        backgroundImage: `url(\"${src}\")`,\n      }}\n      onClick={handleClick}\n    >\n      <CreditLineLink onClick={handleCreditLineClicked}>\n        <CreditLine padding={2} radius={2} margin={2}>\n          <Text size={1} title={`Open image by ${userName} on Unsplash in new window`}>\n            By @{data.user.username}\n          </Text>\n        </CreditLine>\n      </CreditLineLink>\n    </Root>\n  )\n}\n","import { defer, concat, BehaviorSubject, Observable } from 'rxjs'\nimport { debounceTime, switchMap, map, distinctUntilChanged, withLatestFrom } from 'rxjs/operators'\nimport { UnsplashPhoto } from '../types'\nimport { SanityClient } from '@sanity/client'\n\ntype SearchSubject = BehaviorSubject<string>\ntype PageSubject = BehaviorSubject<number>\n\nconst fetchSearch = (\n  client: SanityClient,\n  query: string,\n  page: number,\n  perPage: number\n): Observable<any> =>\n  defer(\n    () =>\n      client.observable.request({\n        url: `/addons/unsplash/search/photos?query=${encodeURIComponent(\n          query\n        )}&page=${page}&per_page=${perPage}`,\n        withCredentials: true,\n        method: 'GET',\n      }) as any\n  )\n\nconst fetchList = (\n  client: SanityClient,\n  type: string,\n  page: number,\n  perPage: number\n): Observable<any> =>\n  defer(\n    () =>\n      client.observable.request({\n        url: `/addons/unsplash/photos?order_by=${type}&page=${page}&per_page=${perPage}`,\n        withCredentials: true,\n        method: 'GET',\n      }) as any\n  )\n\nexport function fetchDownloadUrl(client: SanityClient, photo: UnsplashPhoto): Promise<string> {\n  const downloadUrl = photo.links.download_location.replace(\n    'https://api.unsplash.com',\n    '/addons/unsplash'\n  )\n  return client\n    .request({\n      url: downloadUrl,\n      withCredentials: true,\n      method: 'GET',\n    })\n    .then((result: { url: string }) => {\n      return result.url\n    })\n}\n\nexport const search = (\n  client: SanityClient,\n  query: SearchSubject,\n  page: PageSubject,\n  resultsPerPage: number\n): Observable<any> => {\n  return concat(\n    query.pipe(\n      withLatestFrom(page),\n      debounceTime(500),\n      distinctUntilChanged(),\n      switchMap(([q, p]) => {\n        if (q) {\n          return fetchSearch(client, q, p, resultsPerPage).pipe(\n            distinctUntilChanged(),\n            map((result) => result.results)\n          )\n        }\n        return fetchList(client, 'popular', p, resultsPerPage)\n      })\n    )\n  )\n}\n","import { Stack } from '@sanity/ui'\nimport styled from 'styled-components'\n\nexport const Search = styled(Stack)`\n  position: sticky;\n  top: 0;\n  z-index: 1;\n`\n\nexport const Scroller = styled.div`\n  overflow-y: auto;\n  max-height: 80vh;\n`\n","import React from 'react'\nimport PhotoAlbum from 'react-photo-album'\nimport flatten from 'lodash/flatten'\nimport { BehaviorSubject, Subscription } from 'rxjs'\nimport { UnsplashPhoto } from '../types'\nimport Photo from './Photo'\nimport { fetchDownloadUrl, search } from '../datastores/unsplash'\nimport { Card, Dialog, Flex, Spinner, Stack, Text, TextInput } from '@sanity/ui'\nimport { Search } from './UnsplashAssetSource.styled'\nimport InfiniteScroll from 'react-infinite-scroll-component'\nimport { useClient, AssetSourceComponentProps, AssetFromSource } from 'sanity'\nimport { SanityClient } from '@sanity/client'\n\ntype State = {\n  query: string\n  searchResults: UnsplashPhoto[][]\n  page: number\n  isLoading: boolean\n  cursor: number\n}\n\nconst RESULTS_PER_PAGE = 42\nconst PHOTO_SPACING = 2\nconst PHOTO_PADDING = 1 // offset the 1px border width\n\nexport default function UnsplashAssetSource(props: AssetSourceComponentProps) {\n  const client = useClient({ apiVersion: '2022-09-01' })\n  return <UnsplashAssetSourceInternal {...props} client={client} />\n}\n\nclass UnsplashAssetSourceInternal extends React.Component<\n  AssetSourceComponentProps & { client: SanityClient },\n  State\n> {\n  static defaultProps = {\n    selectedAssets: undefined,\n  }\n\n  state = {\n    cursor: 0,\n    query: '',\n    page: 1,\n    searchResults: [[]],\n    isLoading: true,\n  }\n\n  searchSubscription: Subscription | null = null\n\n  searchSubject$ = new BehaviorSubject('')\n  pageSubject$ = new BehaviorSubject(1)\n\n  componentDidMount() {\n    this.searchSubscription = search(\n      this.props.client,\n      this.searchSubject$,\n      this.pageSubject$,\n      RESULTS_PER_PAGE\n    ).subscribe({\n      next: (results: UnsplashPhoto[]) => {\n        this.setState((prev) => ({\n          searchResults: [...prev.searchResults, results],\n          isLoading: false,\n        }))\n      },\n    })\n  }\n\n  componentWillUnmount() {\n    if (this.searchSubscription) {\n      this.searchSubscription.unsubscribe()\n    }\n  }\n\n  handleSelect = (photo: UnsplashPhoto) => {\n    this.setState({ isLoading: true })\n    return fetchDownloadUrl(this.props.client, photo).then((downloadUrl) => {\n      const description = photo.description || undefined\n      const asset: AssetFromSource = {\n        kind: 'url',\n        value: downloadUrl,\n        assetDocumentProps: {\n          _type: 'sanity.imageAsset',\n          source: {\n            name: 'unsplash',\n            id: photo.id,\n            url: photo.links.html,\n          },\n          description,\n          creditLine: `${photo.user.name} by Unsplash`,\n        } as any,\n      }\n      this.props.onSelect([asset])\n    })\n  }\n\n  handleClose = () => {\n    this.props.onClose()\n  }\n\n  handleSearchTermChanged = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const query = event.currentTarget.value\n    this.setState({ query, page: 1, searchResults: [[]], isLoading: true, cursor: 0 })\n    this.pageSubject$.next(1)\n    this.searchSubject$.next(query)\n  }\n\n  handleScollerLoadMore = () => {\n    // eslint-disable-next-line react/no-access-state-in-setstate\n    const nextPage = this.state.page + 1\n    this.setState({ page: nextPage, isLoading: true })\n    this.pageSubject$.next(nextPage)\n    this.searchSubject$.next(this.state.query)\n  }\n\n  handleKeyDown = (event: any) => {\n    const { cursor } = this.state\n    if ((event.keyCode === 38 || event.keyCode === 37) && cursor > 0) {\n      this.setState((prevState) => ({\n        cursor: prevState.cursor - 1,\n      }))\n    } else if (\n      (event.keyCode === 40 || event.keyCode === 39) &&\n      cursor < this.getPhotos().length - 1\n    ) {\n      this.setState((prevState) => ({\n        cursor: prevState.cursor + 1,\n      }))\n    }\n  }\n\n  getPhotos() {\n    return flatten(this.state.searchResults)\n  }\n\n  updateCursor = (photo: UnsplashPhoto) => {\n    const index = this.getPhotos().findIndex((result: UnsplashPhoto) => result.id === photo.id)\n    this.setState({ cursor: index })\n  }\n\n  renderImage = (props: any) => {\n    const { photo, layout } = props\n    const active =\n      this.getPhotos().findIndex((result: UnsplashPhoto) => result.id === photo.data.id) ===\n        this.state.cursor || false\n    return (\n      <Photo\n        onClick={this.handleSelect.bind(photo.data)}\n        onKeyDown={this.handleKeyDown}\n        data={photo.data}\n        width={layout.width}\n        height={layout.height}\n        active={active}\n        onFocus={this.updateCursor}\n      />\n    )\n  }\n\n  render() {\n    const { query, searchResults, isLoading } = this.state\n\n    return (\n      <Dialog\n        id=\"unsplash-asset-source\"\n        header=\"Select image from Unsplash\"\n        onClose={this.handleClose}\n        open\n        width={4}\n      >\n        <Stack space={3} padding={4}>\n          <Card>\n            <Search space={3}>\n              <Text size={1} weight=\"semibold\">\n                Search Unsplash\n              </Text>\n              <TextInput\n                label=\"Search Unsplash.com\"\n                placeholder=\"Topics or colors\"\n                value={query}\n                onChange={this.handleSearchTermChanged}\n              />\n            </Search>\n          </Card>\n          {!isLoading && this.getPhotos().length === 0 && (\n            <Text size={1} muted>\n              No results found\n            </Text>\n          )}\n          <InfiniteScroll\n            dataLength={this.getPhotos().length} // This is important field to render the next data\n            next={this.handleScollerLoadMore}\n            // scrollableTarget=\"unsplash-scroller\"\n            hasMore\n            scrollThreshold={0.99}\n            height=\"60vh\"\n            loader={\n              <Flex align=\"center\" justify=\"center\" padding={3}>\n                <Spinner muted />\n              </Flex>\n            }\n            endMessage={\n              <Text size={1} muted>\n                No more results\n              </Text>\n            }\n          >\n            {searchResults\n              .filter((photos) => photos.length > 0)\n              .map((photos: UnsplashPhoto[], index) => (\n                <PhotoAlbum\n                  key={`gallery-${query || 'popular'}-${index}`}\n                  layout=\"rows\"\n                  spacing={PHOTO_SPACING}\n                  padding={PHOTO_PADDING}\n                  targetRowHeight={(width) => {\n                    if (width < 300) return 150\n                    else if (width < 600) return 200\n                    return 300\n                  }}\n                  photos={photos.map((photo: UnsplashPhoto) => ({\n                    src: photo.urls.small,\n                    width: photo.width,\n                    height: photo.height,\n                    key: photo.id,\n                    data: photo,\n                  }))}\n                  renderPhoto={this.renderImage}\n                  componentsProps={{\n                    containerProps: { style: { marginBottom: `${PHOTO_SPACING}px` } },\n                  }}\n                />\n              ))}\n          </InfiniteScroll>\n        </Stack>\n      </Dialog>\n    )\n  }\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst Svg = styled.svg`\n  transform: scale(0.8);\n  transform-origin: top;\n`\n\nexport default function UnsplashIcon() {\n  return (\n    <Svg role=\"img\" viewBox=\"0 0 24 24\" width=\"1em\" height=\"1em\" fill=\"currentColor\">\n      <title />\n      <path d=\"M7.5 6.75V0h9v6.75h-9zm9 3.75H24V24H0V10.5h7.5v6.75h9V10.5z\" />\n    </Svg>\n  )\n}\n","import Unsplash from './components/UnsplashAssetSource'\nimport Icon from './components/Icon'\nimport { definePlugin, AssetSource } from 'sanity'\n\nexport type { UnsplashPhoto, Asset, AssetDocument } from './types'\n\n/**\n * @public\n */\nexport const unsplashAssetSource: AssetSource = {\n  name: 'unsplash',\n  title: 'Unsplash',\n  component: Unsplash,\n  icon: Icon,\n}\n\n/**\n * @public\n */\nexport const unsplashImageAsset = definePlugin({\n  name: 'asset-source-unsplash-plugin',\n\n  form: {\n    image: {\n      assetSources: (prev) => {\n        return [...prev, unsplashAssetSource]\n      },\n    },\n  },\n})\n"],"names":["Root","styled","div","_templateObject","_taggedTemplateLiteral","_ref","studioTheme","color","card","enabled","border","CreditLineLink","a","_templateObject2","CreditLine","Card","_templateObject3","_ref2","theme","sanity","fg","bg","Photo","props","onClick","data","onKeyDown","onFocus","active","width","height","rootElm","useRef","prevActive","handleClick","useCallback","handleCreditLineClicked","event","stopPropagation","url","concat","links","html","encodeURIComponent","window","open","id","handleKeyDown","keyCode","handleMouseDown","useEffect","current","focus","src","urls","small","userName","user","name","useTheme","jsx","ref","title","tabIndex","onMouseDown","style","backgroundImage","children","padding","radius","margin","jsxs","Text","size","username","search","client","query","page","resultsPerPage","pipe","withLatestFrom","debounceTime","distinctUntilChanged","switchMap","_ref3","q","p","perPage","defer","observable","request","withCredentials","method","fetchSearch","map","result","results","type","fetchList","Search","Stack","_templateObject4","_templateObject5","UnsplashAssetSourceInternal","React","Component","constructor","super","arguments","this","state","cursor","searchResults","isLoading","searchSubscription","searchSubject$","BehaviorSubject","pageSubject$","handleSelect","photo","setState","downloadUrl","download_location","replace","then","fetchDownloadUrl","description","asset","kind","value","assetDocumentProps","_type","source","creditLine","onSelect","handleClose","onClose","handleSearchTermChanged","currentTarget","next","handleScollerLoadMore","nextPage","prevState","getPhotos","length","updateCursor","index","findIndex","renderImage","layout","bind","componentDidMount","subscribe","prev","componentWillUnmount","unsubscribe","flatten","render","Dialog","header","space","weight","TextInput","label","placeholder","onChange","muted","InfiniteScroll","dataLength","hasMore","scrollThreshold","loader","Flex","align","justify","Spinner","endMessage","filter","photos","PhotoAlbum","spacing","targetRowHeight","key","renderPhoto","componentsProps","containerProps","marginBottom","defaultProps","selectedAssets","Svg","svg","_templateObject6","unsplashAssetSource","component","useClient","apiVersion","icon","role","viewBox","fill","d","unsplashImageAsset","definePlugin","form","image","assetSources"],"mappings":"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"}